<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>My Applications - Bank Cards</title>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap/5.3.0/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <style>
        .navbar {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        }
        .main-content {
            margin-top: 80px;
        }
        .request-item {
            transition: all 0.3s ease;
            border-left: 4px solid transparent;
            cursor: pointer;
        }
        .request-item:hover {
            border-left-color: #007bff;
            box-shadow: 0 4px 12px rgba(0,0,0,0.15);
        }
        .status-badge {
            font-size: 0.9rem;
            padding: 0.5rem 1rem;
        }
        .filter-section {
            background: #f8f9fa;
            border-radius: 10px;
            padding: 1.5rem;
            margin-bottom: 2rem;
        }
        .info-card {
            border-left: 4px solid #007bff;
            transition: all 0.3s ease;
        }
        .info-card:hover {
            box-shadow: 0 4px 12px rgba(0,0,0,0.15);
        }
        .btn-gradient {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            border: none;
            color: white;
        }
        .btn-gradient:hover {
            background: linear-gradient(135deg, #5a6fd8 0%, #6a4190 100%);
            color: white;
        }
        .timeline-item {
            position: relative;
            padding-left: 3rem;
            margin-bottom: 2rem;
        }
        .timeline-item::before {
            content: '';
            position: absolute;
            left: 1rem;
            top: 0;
            bottom: -2rem;
            width: 2px;
            background: #dee2e6;
        }
        .timeline-item:last-child::before {
            bottom: 0;
        }
        .timeline-marker {
            position: absolute;
            left: 0.5rem;
            top: 0.5rem;
            width: 1rem;
            height: 1rem;
            background: white;
            border: 3px solid #007bff;
            border-radius: 50%;
        }
        .timeline-marker.pending {
            border-color: #ffc107;
        }
        .timeline-marker.approved {
            border-color: #28a745;
        }
        .timeline-marker.rejected {
            border-color: #dc3545;
        }
        .timeline-marker.cancelled {
            border-color: #6c757d;
        }
    </style>
</head>
<body>
<!-- Navigation -->
<nav class="navbar navbar-expand-lg navbar-dark fixed-top">
    <div class="container">
        <a class="navbar-brand" href="#">
            <i class="fas fa-university me-2"></i>Bank Cards
        </a>
        <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav">
            <span class="navbar-toggler-icon"></span>
        </button>
        <div class="collapse navbar-collapse" id="navbarNav">
            <ul class="navbar-nav me-auto">
                <li class="nav-item">
                    <a class="nav-link" href="user-profile.html"><i class="fas fa-user me-1"></i>Profile</a>
                </li>
                <li class="nav-item">
                    <a class="nav-link active" href="#"><i class="fas fa-file-alt me-1"></i>Applications</a>
                </li>
                <li class="nav-item">
                    <a class="nav-link" href="user-transactions.html"><i class="fas fa-history me-1"></i>Transactions</a>
                </li>
                <li class="nav-item">
                    <a class="nav-link" href="user-transfer.html"><i class="fas fa-exchange-alt me-1"></i>Transfer</a>
                </li>
            </ul>
            <ul class="navbar-nav">
                <li class="nav-item dropdown">
                    <a class="nav-link dropdown-toggle" href="#" role="button" data-bs-toggle="dropdown">
                        <i class="fas fa-user-circle me-1"></i>John Doe
                    </a>
                    <ul class="dropdown-menu">
                        <li><a class="dropdown-item" href="#"><i class="fas fa-cog me-2"></i>Settings</a></li>
                        <li><hr class="dropdown-divider"></li>
                        <li><a class="dropdown-item" href="#" onclick="logout()"><i class="fas fa-sign-out-alt me-2"></i>Logout</a></li>
                    </ul>
                </li>
            </ul>
        </div>
    </div>
</nav>

<!-- Main Content -->
<div class="container main-content">
    <!-- Page Header -->
    <div class="row mb-4">
        <div class="col-12">
            <div class="d-flex justify-content-between align-items-center">
                <div>
                    <h2><i class="fas fa-file-alt me-2"></i>My Applications & Requests</h2>
                    <p class="text-muted">Track your card applications and blocking requests</p>
                </div>
                <div class="btn-group" role="group">
                    <button class="btn btn-gradient" data-bs-toggle="modal" data-bs-target="#newCardModal">
                        <i class="fas fa-plus me-2"></i>New Card Application
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Quick Stats -->
    <div class="row mb-4">
        <div class="col-md-3">
            <div class="card info-card">
                <div class="card-body text-center">
                    <i class="fas fa-file-alt fa-2x text-primary mb-2"></i>
                    <h5 class="card-title">Total Applications</h5>
                    <h3 class="text-primary" id="totalApplications">5</h3>
                </div>
            </div>
        </div>
        <div class="col-md-3">
            <div class="card info-card">
                <div class="card-body text-center">
                    <i class="fas fa-clock fa-2x text-warning mb-2"></i>
                    <h5 class="card-title">Pending</h5>
                    <h3 class="text-warning" id="pendingApplications">2</h3>
                </div>
            </div>
        </div>
        <div class="col-md-3">
            <div class="card info-card">
                <div class="card-body text-center">
                    <i class="fas fa-check-circle fa-2x text-success mb-2"></i>
                    <h5 class="card-title">Approved</h5>
                    <h3 class="text-success" id="approvedApplications">2</h3>
                </div>
            </div>
        </div>
        <div class="col-md-3">
            <div class="card info-card">
                <div class="card-body text-center">
                    <i class="fas fa-ban fa-2x text-danger mb-2"></i>
                    <h5 class="card-title">Block Requests</h5>
                    <h3 class="text-danger" id="blockRequests">1</h3>
                </div>
            </div>
        </div>
    </div>

    <!-- Filters -->
    <div class="filter-section">
        <div class="row">
            <div class="col-md-3">
                <label class="form-label fw-bold">Filter by Type</label>
                <select class="form-select" id="typeFilter" onchange="filterRequests()">
                    <option value="">All Types</option>
                    <option value="CARD_APPLICATION">Card Applications</option>
                    <option value="BLOCK_REQUEST">Block Requests</option>
                </select>
            </div>
            <div class="col-md-3">
                <label class="form-label fw-bold">Filter by Status</label>
                <select class="form-select" id="statusFilter" onchange="filterRequests()">
                    <option value="">All Status</option>
                    <option value="PENDING">Pending</option>
                    <option value="APPROVED">Approved</option>
                    <option value="REJECTED">Rejected</option>
                    <option value="CANCELLED">Cancelled</option>
                </select>
            </div>
            <div class="col-md-3">
                <label class="form-label fw-bold">Sort by</label>
                <select class="form-select" id="sortBy" onchange="sortRequests()">
                    <option value="date_desc">Date (Newest First)</option>
                    <option value="date_asc">Date (Oldest First)</option>
                    <option value="status">Status</option>
                    <option value="type">Type</option>
                </select>
            </div>
            <div class="col-md-3">
                <label class="form-label fw-bold">Search</label>
                <input type="text" class="form-control" id="searchRequests" placeholder="Search..." onkeyup="searchRequests()">
            </div>
        </div>
    </div>

    <!-- Requests Timeline -->
    <div class="row">
        <div class="col-12">
            <div class="card">
                <div class="card-header">
                    <h5 class="mb-0"><i class="fas fa-history me-2"></i>Requests Timeline</h5>
                </div>
                <div class="card-body">
                    <div id="requestsContainer">
                        <!-- Card Application - Pending -->
                        <div class="timeline-item request-item" data-type="CARD_APPLICATION" data-status="PENDING" data-date="2024-09-15">
                            <div class="timeline-marker pending"></div>
                            <div class="card border-0 shadow-sm">
                                <div class="card-body">
                                    <div class="d-flex justify-content-between align-items-start mb-3">
                                        <div>
                                            <h6 class="card-title mb-1">
                                                <i class="fas fa-credit-card text-primary me-2"></i>Credit Card Application
                                            </h6>
                                            <small class="text-muted">Application ID: #APP-2024-001</small>
                                        </div>
                                        <span class="badge bg-warning status-badge">PENDING</span>
                                    </div>
                                    <p class="card-text text-muted mb-3">Request for a new Credit Card for online purchases and travel expenses.</p>
                                    <div class="row text-center mb-3">
                                        <div class="col-4">
                                            <small class="text-muted">Submitted</small>
                                            <div class="fw-bold">Sep 15, 2024</div>
                                        </div>
                                        <div class="col-4">
                                            <small class="text-muted">Card Type</small>
                                            <div class="fw-bold">CREDIT</div>
                                        </div>
                                        <div class="col-4">
                                            <small class="text-muted">Est. Processing</small>
                                            <div class="fw-bold">3-5 days</div>
                                        </div>
                                    </div>
                                    <div class="d-flex gap-2">
                                        <button class="btn btn-outline-danger btn-sm" onclick="cancelApplication(1)">
                                            <i class="fas fa-times me-1"></i>Cancel
                                        </button>
                                        <button class="btn btn-outline-info btn-sm" onclick="viewApplicationDetails(1)">
                                            <i class="fas fa-eye me-1"></i>Details
                                        </button>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Block Request - Approved -->
                        <div class="timeline-item request-item" data-type="BLOCK_REQUEST" data-status="APPROVED" data-date="2024-09-10">
                            <div class="timeline-marker approved"></div>
                            <div class="card border-0 shadow-sm">
                                <div class="card-body">
                                    <div class="d-flex justify-content-between align-items-start mb-3">
                                        <div>
                                            <h6 class="card-title mb-1">
                                                <i class="fas fa-ban text-danger me-2"></i>Card Block Request
                                            </h6>
                                            <small class="text-muted">Request ID: #BLK-2024-003</small>
                                        </div>
                                        <span class="badge bg-success status-badge">APPROVED</span>
                                    </div>
                                    <p class="card-text text-muted mb-3">Block request for Virtual Card •••• •••• •••• 9012 due to suspicious activity.</p>
                                    <div class="row text-center mb-3">
                                        <div class="col-4">
                                            <small class="text-muted">Submitted</small>
                                            <div class="fw-bold">Sep 10, 2024</div>
                                        </div>
                                        <div class="col-4">
                                            <small class="text-muted">Card Number</small>
                                            <div class="fw-bold">•••• 9012</div>
                                        </div>
                                        <div class="col-4">
                                            <small class="text-muted">Reason</small>
                                            <div class="fw-bold">SUSPICIOUS</div>
                                        </div>
                                    </div>
                                    <div class="alert alert-success py-2 mb-2">
                                        <small><i class="fas fa-check-circle me-1"></i>Card has been successfully blocked</small>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Card Application - Approved -->
                        <div class="timeline-item request-item" data-type="CARD_APPLICATION" data-status="APPROVED" data-date="2024-08-20">
                            <div class="timeline-marker approved"></div>
                            <div class="card border-0 shadow-sm">
                                <div class="card-body">
                                    <div class="d-flex justify-content-between align-items-start mb-3">
                                        <div>
                                            <h6 class="card-title mb-1">
                                                <i class="fas fa-credit-card text-primary me-2"></i>Debit Card Application
                                            </h6>
                                            <small class="text-muted">Application ID: #APP-2024-002</small>
                                        </div>
                                        <span class="badge bg-success status-badge">APPROVED</span>
                                    </div>
                                    <p class="card-text text-muted mb-3">Request for a new Debit Card for daily transactions and ATM withdrawals.</p>
                                    <div class="row text-center mb-3">
                                        <div class="col-4">
                                            <small class="text-muted">Submitted</small>
                                            <div class="fw-bold">Aug 20, 2024</div>
                                        </div>
                                        <div class="col-4">
                                            <small class="text-muted">Approved</small>
                                            <div class="fw-bold">Aug 22, 2024</div>
                                        </div>
                                        <div class="col-4">
                                            <small class="text-muted">Card Created</small>
                                            <div class="fw-bold">•••• 1234</div>
                                        </div>
                                    </div>
                                    <div class="alert alert-success py-2 mb-2">
                                        <small><i class="fas fa-check-circle me-1"></i>Card has been created and activated</small>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Card Application - Rejected -->
                        <div class="timeline-item request-item" data-type="CARD_APPLICATION" data-status="REJECTED" data-date="2024-07-15">
                            <div class="timeline-marker rejected"></div>
                            <div class="card border-0 shadow-sm">
                                <div class="card-body">
                                    <div class="d-flex justify-content-between align-items-start mb-3">
                                        <div>
                                            <h6 class="card-title mb-1">
                                                <i class="fas fa-credit-card text-primary me-2"></i>Prepaid Card Application
                                            </h6>
                                            <small class="text-muted">Application ID: #APP-2024-003</small>
                                        </div>
                                        <span class="badge bg-danger status-badge">REJECTED</span>
                                    </div>
                                    <p class="card-text text-muted mb-3">Request for a new Prepaid Card for gift purposes.</p>
                                    <div class="row text-center mb-3">
                                        <div class="col-4">
                                            <small class="text-muted">Submitted</small>
                                            <div class="fw-bold">Jul 15, 2024</div>
                                        </div>
                                        <div class="col-4">
                                            <small class="text-muted">Rejected</small>
                                            <div class="fw-bold">Jul 16, 2024</div>
                                        </div>
                                        <div class="col-4">
                                            <small class="text-muted">Card Type</small>
                                            <div class="fw-bold">PREPAID</div>
                                        </div>
                                    </div>
                                    <div class="alert alert-danger py-2 mb-2">
                                        <small><i class="fas fa-times-circle me-1"></i>Insufficient documentation provided</small>
                                    </div>
                                    <button class="btn btn-outline-primary btn-sm" onclick="resubmitApplication(3)">
                                        <i class="fas fa-redo me-1"></i>Resubmit Application
                                    </button>
                                </div>
                            </div>
                        </div>

                        <!-- Card Application - Pending -->
                        <div class="timeline-item request-item" data-type="CARD_APPLICATION" data-status="PENDING" data-date="2024-09-18">
                            <div class="timeline-marker pending"></div>
                            <div class="card border-0 shadow-sm">
                                <div class="card-body">
                                    <div class="d-flex justify-content-between align-items-start mb-3">
                                        <div>
                                            <h6 class="card-title mb-1">
                                                <i class="fas fa-credit-card text-primary me-2"></i>Virtual Card Application
                                            </h6>
                                            <small class="text-muted">Application ID: #APP-2024-004</small>
                                        </div>
                                        <span class="badge bg-warning status-badge">PENDING</span>
                                    </div>
                                    <p class="card-text text-muted mb-3">Request for a new Virtual Card for secure online shopping.</p>
                                    <div class="row text-center mb-3">
                                        <div class="col-4">
                                            <small class="text-muted">Submitted</small>
                                            <div class="fw-bold">Sep 18, 2024</div>
                                        </div>
                                        <div class="col-4">
                                            <small class="text-muted">Card Type</small>
                                            <div class="fw-bold">VIRTUAL</div>
                                        </div>
                                        <div class="col-4">
                                            <small class="text-muted">Est. Processing</small>
                                            <div class="fw-bold">1-2 days</div>
                                        </div>
                                    </div>
                                    <div class="d-flex gap-2">
                                        <button class="btn btn-outline-danger btn-sm" onclick="cancelApplication(4)">
                                            <i class="fas fa-times me-1"></i>Cancel
                                        </button>
                                        <button class="btn btn-outline-info btn-sm" onclick="viewApplicationDetails(4)">
                                            <i class="fas fa-eye me-1"></i>Details
                                        </button>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- No Results Message -->
                    <div id="noResultsMessage" style="display: none;">
                        <div class="text-center py-5">
                            <i class="fas fa-search fa-4x text-muted mb-3"></i>
                            <h4 class="text-muted">No requests found</h4>
                            <p class="text-muted">Try adjusting your filters or submit a new application.</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- New Card Application Modal -->
<div class="modal fade" id="newCardModal" tabindex="-1">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title"><i class="fas fa-plus me-2"></i>Apply for New Card</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
            </div>
            <div class="modal-body">
                <form id="newCardForm">
                    <div class="mb-3">
                        <label class="form-label fw-bold">Card Type</label>
                        <select class="form-select" id="cardType" required>
                            <option value="">Select card type</option>
                            <option value="DEBIT">Debit Card</option>
                            <option value="CREDIT">Credit Card</option>
                            <option value="VIRTUAL">Virtual Card</option>
                            <option value="PREPAID">Prepaid Card</option>
                        </select>
                    </div>
                    <div class="mb-3">
                        <label class="form-label fw-bold">Reason for Application</label>
                        <textarea class="form-control" id="applicationReason" rows="3" placeholder="Please describe why you need this card..."></textarea>
                    </div>
                    <div class="alert alert-info">
                        <i class="fas fa-info-circle me-2"></i>
                        Your application will be reviewed by our team. You'll receive a notification once it's processed.
                    </div>
                </form>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
                <button type="button" class="btn btn-gradient" onclick="submitCardApplication()">Submit Application</button>
            </div>
        </div>
    </div>
</div>

<script src="https://cdnjs.cloudflare.com/ajax/libs/bootstrap/5.3.0/js/bootstrap.bundle.min.js"></script>
<script>
    // Initialize page
    document.addEventListener('DOMContentLoaded', function() {
        updateStats();
    });

    // Update statistics
    function updateStats() {
        const items = document.querySelectorAll('.request-item');
        const pending = document.querySelectorAll('.request-item[data-status="PENDING"]');
        const approved = document.querySelectorAll('.request-item[data-status="APPROVED"]');
        const blockRequests = document.querySelectorAll('.request-item[data-type="BLOCK_REQUEST"]');

        document.getElementById('totalApplications').textContent = items.length;
        document.getElementById('pendingApplications').textContent = pending.length;
        document.getElementById('approvedApplications').textContent = approved.length;
        document.getElementById('blockRequests').textContent = blockRequests.length;
    }

    // Filter requests
    function filterRequests() {
        const typeFilter = document.getElementById('typeFilter').value;
        const statusFilter = document.getElementById('statusFilter').value;
        const searchTerm = document.getElementById('searchRequests').value.toLowerCase();

        const items = document.querySelectorAll('.request-item');
        let visibleCount = 0;

        items.forEach(item => {
            const itemType = item.dataset.type;
            const itemStatus = item.dataset.status;
            const itemText = item.textContent.toLowerCase();

            const typeMatch = !typeFilter || itemType === typeFilter;
            const statusMatch = !statusFilter || itemStatus === statusFilter;
            const searchMatch = !searchTerm || itemText.includes(searchTerm);

            if (typeMatch && statusMatch && searchMatch) {
                item.style.display = 'block';
                visibleCount++;
            } else {
                item.style.display = 'none';
            }
        });

        document.getElementById('noResultsMessage').style.display = visibleCount === 0 ? 'block' : 'none';
    }

    // Search requests
    function searchRequests() {
        filterRequests();
    }

    // Sort requests
    function sortRequests() {
        const sortBy = document.getElementById('sortBy').value;
        const container = document.getElementById('requestsContainer');
        const items = Array.from(document.querySelectorAll('.request-item'));

        items.sort((a, b) => {
            switch(sortBy) {
                case 'date_desc':
                    return new Date(b.dataset.date) - new Date(a.dataset.date);
                case 'date_asc':
                    return new Date(a.dataset.date) - new Date(b.dataset.date);
                case 'status':
                    return a.dataset.status.localeCompare(b.dataset.status);
                case 'type':
                    return a.dataset.type.localeCompare(b.dataset.type);
                default:
                    return 0;
            }
        });

        items.forEach(item => container.appendChild(item));
    }

    // Submit new card application
    function submitCardApplication() {
        const cardType = document.getElementById('cardType').value;
        const reason = document.getElementById('applicationReason').value;

        if (!cardType) {
            alert('Please select a card type');
            return;
        }

        console.log('Submitting card application:', { cardType, reason });
        alert('Card application submitted successfully!');

        const modal = bootstrap.Modal.getInstance(document.getElementById('newCardModal'));
        modal.hide();
        document.getElementById('newCardForm').reset();

        // Refresh page to show new application
        location.reload();
    }

    // Cancel application
    function cancelApplication(appId) {
        if (confirm('Are you sure you want to cancel this application?')) {
            console.log('Cancelling application:', appId);
            alert('Application cancelled successfully!');
            location.reload();
        }
    }

    // View application details
    function viewApplicationDetails(appId) {
        console.log('Viewing application details:', appId);
        alert('Application details would be shown in a modal or new page');
    }

    // Resubmit application
    function resubmitApplication(appId) {
        console.log('Resubmitting application:', appId);
        alert('Resubmission functionality would open the application form with pre-filled data');
    }

    // Logout function
    function logout() {
        if (confirm('Are you sure you want to logout?')) {
            window.location.href = '/login';
        }
    }
</script>
</body>
</html>