<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Transaction History - Bank Cards</title>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap/5.3.0/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <style>
        .navbar {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        }
        .main-content {
            margin-top: 80px;
        }
        .transaction-item {
            transition: all 0.3s ease;
            border-left: 4px solid transparent;
            cursor: pointer;
        }
        .transaction-item:hover {
            border-left-color: #007bff;
            box-shadow: 0 4px 12px rgba(0,0,0,0.15);
            background-color: #f8f9fa;
        }
        .filter-section {
            background: #f8f9fa;
            border-radius: 10px;
            padding: 1.5rem;
            margin-bottom: 2rem;
        }
        .info-card {
            border-left: 4px solid #007bff;
            transition: all 0.3s ease;
        }
        .info-card:hover {
            box-shadow: 0 4px 12px rgba(0,0,0,0.15);
        }
        .btn-gradient {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            border: none;
            color: white;
        }
        .btn-gradient:hover {
            background: linear-gradient(135deg, #5a6fd8 0%, #6a4190 100%);
            color: white;
        }
        .transaction-amount.outgoing {
            color: #dc3545;
        }
        .transaction-amount.incoming {
            color: #28a745;
        }
        .transaction-icon.outgoing {
            color: #dc3545;
        }
        .transaction-icon.incoming {
            color: #28a745;
        }
        .card-mini {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 0.5rem 1rem;
            border-radius: 8px;
            font-family: 'Courier New', monospace;
            font-size: 0.9rem;
            display: inline-block;
        }
        .date-divider {
            position: relative;
            text-align: center;
            margin: 2rem 0 1rem 0;
        }
        .date-divider::before {
            content: '';
            position: absolute;
            top: 50%;
            left: 0;
            right: 0;
            height: 1px;
            background: #dee2e6;
            z-index: 1;
        }
        .date-divider span {
            background: white;
            padding: 0 1rem;
            color: #6c757d;
            font-weight: bold;
            position: relative;
            z-index: 2;
        }
        .status-badge {
            font-size: 0.8rem;
            padding: 0.25rem 0.75rem;
        }
        .chart-container {
            height: 300px;
            background: #f8f9fa;
            border-radius: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
        }
    </style>
</head>
<body>
<!-- Navigation -->
<nav class="navbar navbar-expand-lg navbar-dark fixed-top">
    <div class="container">
        <a class="navbar-brand" href="#">
            <i class="fas fa-university me-2"></i>Bank Cards
        </a>
        <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav">
            <span class="navbar-toggler-icon"></span>
        </button>
        <div class="collapse navbar-collapse" id="navbarNav">
            <ul class="navbar-nav me-auto">
                <li class="nav-item">
                    <a class="nav-link" href="user-profile.html"><i class="fas fa-user me-1"></i>Profile</a>
                </li>
                <li class="nav-item">
                    <a class="nav-link" href="user-applications.html"><i class="fas fa-file-alt me-1"></i>Applications</a>
                </li>
                <li class="nav-item">
                    <a class="nav-link active" href="#"><i class="fas fa-history me-1"></i>Transactions</a>
                </li>
                <li class="nav-item">
                    <a class="nav-link" href="user-transfer.html"><i class="fas fa-exchange-alt me-1"></i>Transfer</a>
                </li>
            </ul>
            <ul class="navbar-nav">
                <li class="nav-item dropdown">
                    <a class="nav-link dropdown-toggle" href="#" role="button" data-bs-toggle="dropdown">
                        <i class="fas fa-user-circle me-1"></i>John Doe
                    </a>
                    <ul class="dropdown-menu">
                        <li><a class="dropdown-item" href="#"><i class="fas fa-cog me-2"></i>Settings</a></li>
                        <li><hr class="dropdown-divider"></li>
                        <li><a class="dropdown-item" href="#" onclick="logout()"><i class="fas fa-sign-out-alt me-2"></i>Logout</a></li>
                    </ul>
                </li>
            </ul>
        </div>
    </div>
</nav>

<!-- Main Content -->
<div class="container main-content">
    <!-- Page Header -->
    <div class="row mb-4">
        <div class="col-12">
            <div class="d-flex justify-content-between align-items-center">
                <div>
                    <h2><i class="fas fa-history me-2"></i>Transaction History</h2>
                    <p class="text-muted">View and manage your transaction history</p>
                </div>
                <div class="btn-group" role="group">
                    <button class="btn btn-gradient" onclick="exportTransactions()">
                        <i class="fas fa-download me-2"></i>Export
                    </button>
                    <a href="user-transfer.html" class="btn btn-outline-primary">
                        <i class="fas fa-plus me-2"></i>New Transfer
                    </a>
                </div>
            </div>
        </div>
    </div>

    <!-- Quick Stats -->
    <div class="row mb-4">
        <div class="col-md-3">
            <div class="card info-card">
                <div class="card-body text-center">
                    <i class="fas fa-exchange-alt fa-2x text-primary mb-2"></i>
                    <h5 class="card-title">Total Transactions</h5>
                    <h3 class="text-primary" id="totalTransactions">127</h3>
                </div>
            </div>
        </div>
        <div class="col-md-3">
            <div class="card info-card">
                <div class="card-body text-center">
                    <i class="fas fa-arrow-up fa-2x text-danger mb-2"></i>
                    <h5 class="card-title">Total Sent</h5>
                    <h3 class="text-danger" id="totalSent">$8,450.00</h3>
                </div>
            </div>
        </div>
        <div class="col-md-3">
            <div class="card info-card">
                <div class="card-body text-center">
                    <i class="fas fa-arrow-down fa-2x text-success mb-2"></i>
                    <h5 class="card-title">Total Received</h5>
                    <h3 class="text-success" id="totalReceived">$3,200.00</h3>
                </div>
            </div>
        </div>
        <div class="col-md-3">
            <div class="card info-card">
                <div class="card-body text-center">
                    <i class="fas fa-calendar fa-2x text-info mb-2"></i>
                    <h5 class="card-title">This Month</h5>
                    <h3 class="text-info" id="thisMonth">24</h3>
                </div>
            </div>
        </div>
    </div>

    <!-- Filters and Search -->
    <div class="filter-section">
        <div class="row">
            <div class="col-md-2">
                <label class="form-label fw-bold">Card Filter</label>
                <select class="form-select" id="cardFilter" onchange="filterTransactions()">
                    <option value="">All Cards</option>
                    <option value="1234">•••• 1234</option>
                    <option value="5678">•••• 5678</option>
                    <option value="9012">•••• 9012</option>
                </select>
            </div>
            <div class="col-md-2">
                <label class="form-label fw-bold">Type</label>
                <select class="form-select" id="typeFilter" onchange="filterTransactions()">
                    <option value="">All Types</option>
                    <option value="outgoing">Outgoing</option>
                    <option value="incoming">Incoming</option>
                </select>
            </div>
            <div class="col-md-2">
                <label class="form-label fw-bold">Date From</label>
                <input type="date" class="form-control" id="dateFrom" onchange="filterTransactions()">
            </div>
            <div class="col-md-2">
                <label class="form-label fw-bold">Date To</label>
                <input type="date" class="form-control" id="dateTo" onchange="filterTransactions()">
            </div>
            <div class="col-md-2">
                <label class="form-label fw-bold">Amount</label>
                <select class="form-select" id="amountFilter" onchange="filterTransactions()">
                    <option value="">Any Amount</option>
                    <option value="0-100">$0 - $100</option>
                    <option value="100-500">$100 - $500</option>
                    <option value="500-1000">$500 - $1,000</option>
                    <option value="1000+">$1,000+</option>
                </select>
            </div>
            <div class="col-md-2">
                <label class="form-label fw-bold">Search</label>
                <input type="text" class="form-control" id="searchTransactions" placeholder="Search..." onkeyup="searchTransactions()">
            </div>
        </div>
        <div class="row mt-3">
            <div class="col-12">
                <button class="btn btn-outline-secondary btn-sm me-2" onclick="clearFilters()">
                    <i class="fas fa-times me-1"></i>Clear Filters
                </button>
                <button class="btn btn-outline-info btn-sm" onclick="toggleChart()">
                    <i class="fas fa-chart-line me-1"></i>Show Chart
                </button>
            </div>
        </div>
    </div>

    <!-- Chart Section (Hidden by default) -->
    <div class="row mb-4" id="chartSection" style="display: none;">
        <div class="col-12">
            <div class="card">
                <div class="card-header">
                    <h5 class="mb-0"><i class="fas fa-chart-line me-2"></i>Transaction Trends</h5>
                </div>
                <div class="card-body">
                    <div class="chart-container">
                        <div class="text-center">
                            <i class="fas fa-chart-line fa-3x text-muted mb-3"></i>
                            <p class="text-muted">Chart would be rendered here using Chart.js or similar library</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Transactions List -->
    <div class="row">
        <div class="col-12">
            <div class="card">
                <div class="card-header">
                    <div class="d-flex justify-content-between align-items-center">
                        <h5 class="mb-0"><i class="fas fa-list me-2"></i>Recent Transactions</h5>
                        <div class="d-flex gap-2">
                            <select class="form-select form-select-sm" style="width: auto;" id="sortBy" onchange="sortTransactions()">
                                <option value="date_desc">Date (Newest)</option>
                                <option value="date_asc">Date (Oldest)</option>
                                <option value="amount_desc">Amount (High to Low)</option>
                                <option value="amount_asc">Amount (Low to High)</option>
                            </select>
                            <select class="form-select form-select-sm" style="width: auto;" id="pageSize" onchange="changePageSize()">
                                <option value="10">10 per page</option>
                                <option value="25" selected>25 per page</option>
                                <option value="50">50 per page</option>
                                <option value="100">100 per page</option>
                            </select>
                        </div>
                    </div>
                </div>
                <div class="card-body p-0">
                    <div id="transactionsContainer">
                        <!-- Today's Transactions -->
                        <div class="date-divider">
                            <span>Today - September 20, 2024</span>
                        </div>

                        <!-- Transaction 1 -->
                        <div class="transaction-item p-3 border-bottom" data-type="outgoing" data-card="1234" data-date="2024-09-20" data-amount="250">
                            <div class="d-flex align-items-center">
                                <div class="me-3">
                                    <i class="fas fa-arrow-up transaction-icon outgoing fa-lg"></i>
                                </div>
                                <div class="flex-grow-1">
                                    <div class="d-flex justify-content-between align-items-start mb-1">
                                        <div>
                                            <h6 class="mb-1">Transfer to Credit Card</h6>
                                            <small class="text-muted">Transaction ID: #TXN-2024-0987</small>
                                        </div>
                                        <div class="text-end">
                                            <div class="transaction-amount outgoing fw-bold">-$250.00</div>
                                            <small class="text-muted">2:15 PM</small>
                                        </div>
                                    </div>
                                    <div class="d-flex justify-content-between align-items-center">
                                        <div class="d-flex gap-2">
                                            <span class="card-mini">•••• 1234</span>
                                            <i class="fas fa-arrow-right text-muted"></i>
                                            <span class="card-mini">•••• 5678</span>
                                        </div>
                                        <span class="badge bg-success status-badge">COMPLETED</span>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Transaction 2 -->
                        <div class="transaction-item p-3 border-bottom" data-type="outgoing" data-card="5678" data-date="2024-09-20" data-amount="75">
                            <div class="d-flex align-items-center">
                                <div class="me-3">
                                    <i class="fas fa-arrow-up transaction-icon outgoing fa-lg"></i>
                                </div>
                                <div class="flex-grow-1">
                                    <div class="d-flex justify-content-between align-items-start mb-1">
                                        <div>
                                            <h6 class="mb-1">Transfer to Savings</h6>
                                            <small class="text-muted">Transaction ID: #TXN-2024-0986</small>
                                        </div>
                                        <div class="text-end">
                                            <div class="transaction-amount outgoing fw-bold">-$75.00</div>
                                            <small class="text-muted">10:30 AM</small>
                                        </div>
                                    </div>
                                    <div class="d-flex justify-content-between align-items-center">
                                        <div class="d-flex gap-2">
                                            <span class="card-mini">•••• 5678</span>
                                            <i class="fas fa-arrow-right text-muted"></i>
                                            <span class="card-mini">•••• 1234</span>
                                        </div>
                                        <span class="badge bg-success status-badge">COMPLETED</span>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Yesterday's Transactions -->
                        <div class="date-divider">
                            <span>Yesterday - September 19, 2024</span>
                        </div>

                        <!-- Transaction 3 -->
                        <div class="transaction-item p-3 border-bottom" data-type="incoming" data-card="1234" data-date="2024-09-19" data-amount="500">
                            <div class="d-flex align-items-center">
                                <div class="me-3">
                                    <i class="fas fa-arrow-down transaction-icon incoming fa-lg"></i>
                                </div>
                                <div class="flex-grow-1">
                                    <div class="d-flex justify-content-between align-items-start mb-1">
                                        <div>
                                            <h6 class="mb-1">Received from Credit Card</h6>
                                            <small class="text-muted">Transaction ID: #TXN-2024-0985</small>
                                        </div>
                                        <div class="text-end">
                                            <div class="transaction-amount incoming fw-bold">+$500.00</div>
                                            <small class="text-muted">6:45 PM</small>
                                        </div>
                                    </div>
                                    <div class="d-flex justify-content-between align-items-center">
                                        <div class="d-flex gap-2">
                                            <span class="card-mini">•••• 5678</span>
                                            <i class="fas fa-arrow-right text-muted"></i>
                                            <span class="card-mini">•••• 1234</span>
                                        </div>
                                        <span class="badge bg-success status-badge">COMPLETED</span>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Transaction 4 -->
                        <div class="transaction-item p-3 border-bottom" data-type="outgoing" data-card="1234" data-date="2024-09-19" data-amount="1200">
                            <div class="d-flex align-items-center">
                                <div class="me-3">
                                    <i class="fas fa-arrow-up transaction-icon outgoing fa-lg"></i>
                                </div>
                                <div class="flex-grow-1">
                                    <div class="d-flex justify-content-between align-items-start mb-1">
                                        <div>
                                            <h6 class="mb-1">Large Transfer to Credit Card</h6>
                                            <small class="text-muted">Transaction ID: #TXN-2024-0984</small>
                                        </div>
                                        <div class="text-end">
                                            <div class="transaction-amount outgoing fw-bold">-$1,200.00</div>
                                            <small class="text-muted">2:20 PM</small>
                                        </div>
                                    </div>
                                    <div class="d-flex justify-content-between align-items-center">
                                        <div class="d-flex gap-2">
                                            <span class="card-mini">•••• 1234</span>
                                            <i class="fas fa-arrow-right text-muted"></i>
                                            <span class="card-mini">•••• 5678</span>
                                        </div>
                                        <span class="badge bg-success status-badge">COMPLETED</span>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Earlier Transactions -->
                        <div class="date-divider">
                            <span>September 18, 2024</span>
                        </div>

                        <!-- Transaction 5 -->
                        <div class="transaction-item p-3 border-bottom" data-type="outgoing" data-card="5678" data-date="2024-09-18" data-amount="125">
                            <div class="d-flex align-items-center">
                                <div class="me-3">
                                    <i class="fas fa-arrow-up transaction-icon outgoing fa-lg"></i>
                                </div>
                                <div class="flex-grow-1">
                                    <div class="d-flex justify-content-between align-items-start mb-1">
                                        <div>
                                            <h6 class="mb-1">Quick Transfer</h6>
                                            <small class="text-muted">Transaction ID: #TXN-2024-0983</small>
                                        </div>
                                        <div class="text-end">
                                            <div class="transaction-amount outgoing fw-bold">-$125.00</div>
                                            <small class="text-muted">4:10 PM</small>
                                        </div>
                                    </div>
                                    <div class="d-flex justify-content-between align-items-center">
                                        <div class="d-flex gap-2">
                                            <span class="card-mini">•••• 5678</span>
                                            <i class="fas fa-arrow-right text-muted"></i>
                                            <span class="card-mini">•••• 1234</span>
                                        </div>
                                        <span class="badge bg-success status-badge">COMPLETED</span>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Transaction 6 -->
                        <div class="transaction-item p-3 border-bottom" data-type="incoming" data-card="1234" data-date="2024-09-18" data-amount="300">
                            <div class="d-flex align-items-center">
                                <div class="me-3">
                                    <i class="fas fa-arrow-down transaction-icon incoming fa-lg"></i>
                                </div>
                                <div class="flex-grow-1">
                                    <div class="d-flex justify-content-between align-items-start mb-1">
                                        <div>
                                            <h6 class="mb-1">Transfer from Credit Card</h6>
                                            <small class="text-muted">Transaction ID: #TXN-2024-0982</small>
                                        </div>
                                        <div class="text-end">
                                            <div class="transaction-amount incoming fw-bold">+$300.00</div>
                                            <small class="text-muted">11:15 AM</small>
                                        </div>
                                    </div>
                                    <div class="d-flex justify-content-between align-items-center">
                                        <div class="d-flex gap-2">
                                            <span class="card-mini">•••• 5678</span>
                                            <i class="fas fa-arrow-right text-muted"></i>
                                            <span class="card-mini">•••• 1234</span>
                                        </div>
                                        <span class="badge bg-success status-badge">COMPLETED</span>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- No Results Message -->
                    <div id="noResultsMessage" style="display: none;">
                        <div class="text-center py-5">
                            <i class="fas fa-search fa-4x text-muted mb-3"></i>
                            <h4 class="text-muted">No transactions found</h4>
                            <p class="text-muted">Try adjusting your filters or date range.</p>
                        </div>
                    </div>

                    <!-- Pagination -->
                    <div class="d-flex justify-content-between align-items-center p-3 border-top" id="paginationSection">
                        <div class="text-muted">
                            Showing <span id="showingStart">1</span> to <span id="showingEnd">6</span> of <span id="totalResults">127</span> transactions
                        </div>
                        <nav>
                            <ul class="pagination pagination-sm mb-0">
                                <li class="page-item disabled">
                                    <a class="page-link" href="#" onclick="previousPage()">Previous</a>
                                </li>
                                <li class="page-item active">
                                    <a class="page-link" href="#" onclick="goToPage(1)">1</a>
                                </li>
                                <li class="page-item">
                                    <a class="page-link" href="#" onclick="goToPage(2)">2</a>
                                </li>
                                <li class="page-item">
                                    <a class="page-link" href="#" onclick="goToPage(3)">3</a>
                                </li>
                                <li class="page-item">
                                    <a class="page-link" href="#" onclick="nextPage()">Next</a>
                                </li>
                            </ul>
                        </nav>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- Transaction Details Modal -->
<div class="modal fade" id="transactionModal" tabindex="-1">
    <div class="modal-dialog modal-lg">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title"><i class="fas fa-receipt me-2"></i>Transaction Details</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
            </div>
            <div class="modal-body">
                <!-- Transaction details would be loaded here -->
                <div class="text-center py-4">
                    <i class="fas fa-receipt fa-3x text-muted mb-3"></i>
                    <p class="text-muted">Transaction details would be displayed here</p>
                </div>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-outline-primary" onclick="downloadReceipt()">
                    <i class="fas fa-download me-1"></i>Download Receipt
                </button>
                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
            </div>
        </div>
    </div>
</div>

<script src="https://cdnjs.cloudflare.com/ajax/libs/bootstrap/5.3.0/js/bootstrap.bundle.min.js"></script>
<script>
    let currentPage = 1;
    let pageSize = 25;
    let totalPages = 5;

    // Initialize page
    document.addEventListener('DOMContentLoaded', function() {
        updateStats();
        setupDateFilters();

        // Add click handlers to transaction items
        document.querySelectorAll('.transaction-item').forEach(item => {
            item.addEventListener('click', function() {
                const modal = new bootstrap.Modal(document.getElementById('transactionModal'));
                modal.show();
            });
        });
    });

    // Setup date filters with default values
    function setupDateFilters() {
        const today = new Date();
        const thirtyDaysAgo = new Date(today.getTime() - (30 * 24 * 60 * 60 * 1000));

        document.getElementById('dateTo').value = today.toISOString().split('T')[0];
        document.getElementById('dateFrom').value = thirtyDaysAgo.toISOString().split('T')[0];
    }

    // Update statistics
    function updateStats() {
        // These would typically come from API calls
        document.getElementById('totalTransactions').textContent = '127';
        document.getElementById('totalSent').textContent = '$8,450.00';
        document.getElementById('totalReceived').textContent = '$3,200.00';
        document.getElementById('thisMonth').textContent = '24';
    }

    // Filter transactions
    function filterTransactions() {
        const cardFilter = document.getElementById('cardFilter').value;
        const typeFilter = document.getElementById('typeFilter').value;
        const dateFrom = document.getElementById('dateFrom').value;
        const dateTo = document.getElementById('dateTo').value;
        const amountFilter = document.getElementById('amountFilter').value;
        const searchTerm = document.getElementById('searchTransactions').value.toLowerCase();

        const transactions = document.querySelectorAll('.transaction-item');
        const dateDividers = document.querySelectorAll('.date-divider');
        let visibleCount = 0;

        transactions.forEach(transaction => {
            const transactionCard = transaction.dataset.card;
            const transactionType = transaction.dataset.type;
            const transactionDate = transaction.dataset.date;
            const transactionAmount = parseFloat(transaction.dataset.amount);
            const transactionText = transaction.textContent.toLowerCase();

            // Apply filters
            const cardMatch = !cardFilter || transactionCard === cardFilter;
            const typeMatch = !typeFilter || transactionType === typeFilter;
            const searchMatch = !searchTerm || transactionText.includes(searchTerm);

            // Date range filter
            const dateMatch = (!dateFrom || transactionDate >= dateFrom) &&
                (!dateTo || transactionDate <= dateTo);

            // Amount filter
            let amountMatch = true;
            if (amountFilter) {
                const [min, max] = amountFilter.split('-');
                if (max) {
                    amountMatch = transactionAmount >= parseFloat(min) && transactionAmount <= parseFloat(max);
                } else {
                    amountMatch = transactionAmount >= parseFloat(min.replace('+', ''));
                }
            }

            if (cardMatch && typeMatch && dateMatch && amountMatch && searchMatch) {
                transaction.style.display = 'block';
                visibleCount++;
            } else {
                transaction.style.display = 'none';
            }
        });

        // Show/hide date dividers based on visible transactions
        dateDividers.forEach(divider => {
            const nextTransactions = getNextVisibleTransactions(divider);
            divider.style.display = nextTransactions.length > 0 ? 'block' : 'none';
        });

        // Show/hide no results message
        document.getElementById('noResultsMessage').style.display = visibleCount === 0 ? 'block' : 'none';
        document.getElementById('paginationSection').style.display = visibleCount === 0 ? 'none' : 'flex';
    }

    // Get next visible transactions after a date divider
    function getNextVisibleTransactions(divider) {
        const transactions = [];
        let nextElement = divider.nextElementSibling;

        while (nextElement && !nextElement.classList.contains('date-divider')) {
            if (nextElement.classList.contains('transaction-item') &&
                nextElement.style.display !== 'none') {
                transactions.push(nextElement);
            }
            nextElement = nextElement.nextElementSibling;
        }

        return transactions;
    }

    // Search transactions
    function searchTransactions() {
        filterTransactions();
    }

    // Clear all filters
    function clearFilters() {
        document.getElementById('cardFilter').value = '';
        document.getElementById('typeFilter').value = '';
        document.getElementById('dateFrom').value = '';
        document.getElementById('dateTo').value = '';
        document.getElementById('amountFilter').value = '';
        document.getElementById('searchTransactions').value = '';

        setupDateFilters(); // Reset to default date range
        filterTransactions();
    }

    // Sort transactions
    function sortTransactions() {
        const sortBy = document.getElementById('sortBy').value;
        const container = document.getElementById('transactionsContainer');
        const transactions = Array.from(document.querySelectorAll('.transaction-item'));
        const dateDividers = Array.from(document.querySelectorAll('.date-divider'));

        // Remove all elements from container
        transactions.forEach(t => t.remove());
        dateDividers.forEach(d => d.remove());

        // Sort transactions
        transactions.sort((a, b) => {
            switch(sortBy) {
                case 'date_desc':
                    return new Date(b.dataset.date) - new Date(a.dataset.date);
                case 'date_asc':
                    return new Date(a.dataset.date) - new Date(b.dataset.date);
                case 'amount_desc':
                    return parseFloat(b.dataset.amount) - parseFloat(a.dataset.amount);
                case 'amount_asc':
                    return parseFloat(a.dataset.amount) - parseFloat(b.dataset.amount);
                default:
                    return 0;
            }
        });

        // Re-append sorted transactions with appropriate date dividers
        let currentDate = null;
        transactions.forEach(transaction => {
            const transactionDate = transaction.dataset.date;
            const formattedDate = formatDateDivider(transactionDate);

            if (currentDate !== formattedDate) {
                currentDate = formattedDate;
                const divider = document.createElement('div');
                divider.className = 'date-divider';
                divider.innerHTML = `<span>${formattedDate}</span>`;
                container.appendChild(divider);
            }

            container.appendChild(transaction);
        });
    }

    // Format date for divider
    function formatDateDivider(dateString) {
        const date = new Date(dateString);
        const today = new Date();
        const yesterday = new Date(today.getTime() - 24 * 60 * 60 * 1000);

        if (date.toDateString() === today.toDateString()) {
            return 'Today - ' + date.toLocaleDateString('en-US', {
                year: 'numeric', month: 'long', day: 'numeric'
            });
        } else if (date.toDateString() === yesterday.toDateString()) {
            return 'Yesterday - ' + date.toLocaleDateString('en-US', {
                year: 'numeric', month: 'long', day: 'numeric'
            });
        } else {
            return date.toLocaleDateString('en-US', {
                year: 'numeric', month: 'long', day: 'numeric'
            });
        }
    }

    // Toggle chart visibility
    function toggleChart() {
        const chartSection = document.getElementById('chartSection');
        const button = event.target.closest('button');

        if (chartSection.style.display === 'none') {
            chartSection.style.display = 'block';
            button.innerHTML = '<i class="fas fa-chart-line me-1"></i>Hide Chart';
        } else {
            chartSection.style.display = 'none';
            button.innerHTML = '<i class="fas fa-chart-line me-1"></i>Show Chart';
        }
    }

    // Change page size
    function changePageSize() {
        pageSize = parseInt(document.getElementById('pageSize').value);
        currentPage = 1;
        // Reload transactions with new page size
        console.log('Page size changed to:', pageSize);
    }

    // Pagination functions
    function previousPage() {
        if (currentPage > 1) {
            currentPage--;
            loadPage(currentPage);
        }
    }

    function nextPage() {
        if (currentPage < totalPages) {
            currentPage++;
            loadPage(currentPage);
        }
    }

    function goToPage(page) {
        currentPage = page;
        loadPage(currentPage);
    }

    function loadPage(page) {
        // This would typically make an API call to load the specific page
        console.log('Loading page:', page);

        // Update pagination display
        updatePaginationDisplay();
    }

    function updatePaginationDisplay() {
        const start = ((currentPage - 1) * pageSize) + 1;
        const end = Math.min(currentPage * pageSize, 127); // Total transactions

        document.getElementById('showingStart').textContent = start;
        document.getElementById('showingEnd').textContent = end;

        // Update pagination buttons
        const pagination = document.querySelector('.pagination');
        const items = pagination.querySelectorAll('.page-item');

        // Update previous button
        items[0].classList.toggle('disabled', currentPage === 1);

        // Update next button
        items[items.length - 1].classList.toggle('disabled', currentPage === totalPages);

        // Update page number buttons
        for (let i = 1; i < items.length - 1; i++) {
            items[i].classList.toggle('active', i === currentPage);
        }
    }

    // Export transactions
    function exportTransactions() {
        console.log('Exporting transactions...');

        // Create CSV content
        const headers = ['Date', 'Type', 'From Card', 'To Card', 'Amount', 'Status', 'Transaction ID'];
        const rows = [
            ['2024-09-20', 'Outgoing', '•••• 1234', '•••• 5678', '-$250.00', 'COMPLETED', '#TXN-2024-0987'],
            ['2024-09-20', 'Outgoing', '•••• 5678', '•••• 1234', '-$75.00', 'COMPLETED', '#TXN-2024-0986'],
            ['2024-09-19', 'Incoming', '•••• 5678', '•••• 1234', '+$500.00', 'COMPLETED', '#TXN-2024-0985'],
            // Add more rows as needed
        ];

        let csvContent = headers.join(',') + '\n';
        rows.forEach(row => {
            csvContent += row.map(field => `"${field}"`).join(',') + '\n';
        });

        // Create and download file
        const blob = new Blob([csvContent], { type: 'text/csv' });
        const url = window.URL.createObjectURL(blob);
        const a = document.createElement('a');
        a.href = url;
        a.download = `transactions_${new Date().toISOString().split('T')[0]}.csv`;
        document.body.appendChild(a);
        a.click();
        document.body.removeChild(a);
        window.URL.revokeObjectURL(url);

        alert('Transactions exported successfully!');
    }

    // Download receipt
    function downloadReceipt() {
        console.log('Downloading receipt...');
        alert('Receipt download functionality would be implemented here');
    }

    // Logout function
    function logout() {
        if (confirm('Are you sure you want to logout?')) {
            window.location.href = '/login';
        }
    }

    // Initialize page
    updatePaginationDisplay();
</script>
</body>
</html>